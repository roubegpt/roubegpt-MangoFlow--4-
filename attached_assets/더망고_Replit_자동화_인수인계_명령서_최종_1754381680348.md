
# 🧭 Replit 자동세션용 더망고 프로젝트 인수인계 명령서 (최종 보완판)

이 문서는 Replit에서 새 세션이 열릴 때 **AI 및 개발자가 자동으로 프로젝트를 이어받기 위한 명령서**입니다.  
모든 자동화 흐름, 파일 구조, 실행 절차, 후속 작업 지시를 포함하며 **Replit 환경 최적화 기준**에 따라 작성되었습니다.

---

## 📌 프로젝트 지향점

- **프로젝트명**: 더망고 썸네일 이미지 자동화 시스템
- **지향점**:
  - 크롬 프로필 기반 자동 로그인
  - 관리자 필터별 썸네일 추출 및 AI 유사도 평가
  - Pixian API 기반 배경 제거
  - 실패 필터 재시도 및 로깅
  - 사용자 프론트에서 클릭 한 번으로 전체 자동화 진행
  - AI 학습 기준 반영 가능 (대표 이미지 판단 기준 적용 가능)

---

## 📁 폴더 구조 요약

```
themango_v1/
├── core/                    # 자동화 핵심 모듈 (main_runner, session, 이미지 처리 등)
├── server/                  # Flask 백엔드 API 서버
├── frontend/                # React 프론트엔드 대시보드
├── .env                     # 로그인 정보, Pixian API Key, Chrome 경로 등
└── main.py                  # 프로젝트 진입점
```

---

## 🔧 Replit 환경 특이사항

- Puppeteer 또는 Chrome 사용 시 반드시 Headless 모드 사용 (`headless: 'new'`)
- `.replit`, `replit.nix` 파일이 없으면 생성 필요
- `dotenv`를 통한 `.env` 불러오기 필요 (`SERVICE_URL`, `USERNAME`, `PASSWORD`, `CHROME_PROFILE_PATH`)
- 파일 경로는 `/mnt/data` 또는 상대경로 사용 권장
- 포트 충돌 방지를 위해 Flask는 `port=5000`, React는 `5173` 사용

---

## ✅ 실행 순서 (Replit 전용 기준)

```bash
# 1. 필요한 패키지 설치
pip install flask flask-cors python-dotenv requests
npm install --prefix frontend

# 2. 백엔드 실행
python server/server.py

# 3. 프론트 실행
cd frontend
npm run dev

# 4. 접속
http://localhost:5173
```

---

## 🔐 .env 파일 구성 예시

```env
SERVICE_URL=https://tmg1202.cafe24.com/mall/admin/admin_login.php
USERNAME=roubecompany
PASSWORD=akdrh5fnqm1
PIXIAN_API_KEY=pio3333d4octg65tc6cm74msfs14cmp0mcirkq4pgrch3fg21hts
CHROME_PROFILE_PATH=C:/Users/루브컴퍼니/AppData/Local/Google/Chrome/User Data/Profile 8
```

---

## 🧠 핵심 실행 흐름

```mermaid
graph TD
  A[사용자 프론트 입력] --> B[/run API 호출]
  B --> C[main_runner.py 실행]
  C --> D[크롬 프로필 로그인 시도]
  D --> E[필터 리스트 순회]
  E --> F[썸네일 검증 및 로그 저장]
  F --> G[성공 or 실패 재시도 → 완료]
```

---

## 🧪 테스트 체크리스트

| 항목 | 확인 방법 |
|------|-----------|
| 로그인 성공 | 콘솔에 "[INFO] 로그인 성공" 출력 |
| Pixian API 키 | `POST /run` 실행 시 오류 없이 처리되는지 확인 |
| 프론트 실행 | http://localhost:5173 대시보드 접속 가능 |
| 필터 입력 | 필터 추가 후 "실행" → 진행률 출력 |
| 실패 필터 | failure_collector.py로 후처리 가능한 구조인지 확인

---

## 🧩 다음 작업 지시 (AI 및 개발자 공통)

1. `main_runner.py` 내부 필터별 썸네일 처리 로직 완성
2. `image_updater.py`에 Pixian API 연동 (`requests.post` 방식)
3. `failure_collector.py` 구현 및 로그 기반 재실행 구조 설계
4. `Dashboard.jsx`에서 실행 로그/진행률 UI 고도화
5. `.replit` 및 `replit.nix` 작성 → Flask + React 실행 자동화 설정

---

## 📚 연관 문서/세션 목록

| 문서명 | 설명 |
|--------|------|
| `더망고 프로젝트 인수인계 보고서 (최종판).md` | 전체 흐름 및 모듈 구조 설명 |
| `TheMango_Full_Session_Recovery_2025-08-02.md` | 파일별 코드 포함 백업본 |
| `GPT_TheMango_Session_Backup.md` | 초기 세션 요약 및 실행 흐름 |
| `더망고 프로젝트 인수인계 보고서 (v2, 보완판).txt` | 개선된 실행 안내 및 필터 구조 설명 |

---

**작성자:** GPT-4o (Replit 최적화 버전)  
**지시자:** 사용자 Gizmo  
**최종 갱신일:** 2025-08-05  
**문서 목적:** Replit 새 세션에서 더망고 자동화 시스템을 즉시 복구/실행할 수 있도록 보장

